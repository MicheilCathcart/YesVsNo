!function(){var e=angular.module("yvn.canvass");e.directive("comments",["getComments",function(e){return{restrict:"E",scope:{},templateUrl:"app/canvass/directives/comment.html",controller:function(n){var t=function(e){var n=_.filter(e,function(e){return 0==e.comment_parent_id}),t=_.filter(e,function(e){return 0==!e.comment_parent_id});return console.log(t),_.each(t,function(e){console.log("Iteration");var t=e.comment_parent_id,o=_.filter(n,function(e){return e.comment_id==t});console.log(o),o.comments=[],o.comments.push(e)}),n};n.comments=[];var o=function(){e.comments().success(function(e){n.comments=t(e)})};o(),n.addPostComment=function(){if(n.userComment&&""!==n.userComment){var e={user:n.userName,comment:n.userComment,level:0,tier:1,vote:n.userVote,date:new Date};$http.post("/api/comments/new",e).then(function t(e){o()},function m(e){console.log("Error In Posting?")}),n.userComment=""}},n.toggleCommentMenu=function(e){void 0==e.commentMenuVisible||0==e.commentMenuVisible?e.commentMenuVisible=!0:1==e.commentMenuVisible&&(e.commentMenuVisible=!1)}}}}])}();